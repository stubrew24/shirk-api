{"version":3,"sources":["../src/middleware.js"],"names":["jwt","require","User","mongoose","model","UserSchema","withAuth","req","res","next","token","body","query","headers","cookies","status","json","error","verify","process","env","SECRET","err","decoded","userId","id","module","exports"],"mappings":";;AACA;;AACA;;;;;;AAFA,IAAMA,MAAMC,QAAQ,cAAR,CAAZ;;AAGA,IAAMC,OAAOC,mBAASC,KAAT,CAAe,MAAf,EAAuBC,qBAAvB,CAAb;;AAEA,IAAMC,WAAW,SAAXA,QAAW,CAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACxC,MAAMC,QACJH,IAAII,IAAJ,CAASD,KAAT,IACAH,IAAIK,KAAJ,CAAUF,KADV,IAEAH,IAAIM,OAAJ,CAAY,gBAAZ,CAFA,IAGAN,IAAIO,OAAJ,CAAYJ,KAJd;AAKA,MAAI,CAACA,KAAL,EAAY;AACVF,QAAIO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,iCAAT,EAArB;AACD,GAFD,MAEO;AACLjB,QAAIkB,MAAJ,CAAWR,KAAX,EAAkBS,QAAQC,GAAR,CAAYC,MAA9B,EAAsC,UAASC,GAAT,EAAcC,OAAd,EAAuB;AAC3D,UAAID,GAAJ,EAAS;AACPd,YAAIO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,iCAAT,EAArB;AACD,OAFD,MAEO;AACLV,YAAIiB,MAAJ,GAAaD,QAAQE,EAArB;AACAhB;AACD;AACF,KAPD;AAQD;AACF,CAlBD;AAmBAiB,OAAOC,OAAP,GAAiBrB,QAAjB","file":"middleware.js","sourcesContent":["const jwt = require(\"jsonwebtoken\");\nimport { UserSchema } from \"./models/userModel\";\nimport mongoose from \"mongoose\";\nconst User = mongoose.model(\"user\", UserSchema);\n\nconst withAuth = function(req, res, next) {\n  const token =\n    req.body.token ||\n    req.query.token ||\n    req.headers[\"x-access-token\"] ||\n    req.cookies.token;\n  if (!token) {\n    res.status(401).json({ error: \"Unauthorized: No token provided\" });\n  } else {\n    jwt.verify(token, process.env.SECRET, function(err, decoded) {\n      if (err) {\n        res.status(401).json({ error: \"Unauthorized: No token provided\" });\n      } else {\n        req.userId = decoded.id;\n        next();\n      }\n    });\n  }\n};\nmodule.exports = withAuth;\n"]}